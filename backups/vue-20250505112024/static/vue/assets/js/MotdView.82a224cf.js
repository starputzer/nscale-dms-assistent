import{u as V}from"./motdStore.0cd3536c.js";import{_ as E,g as C,h as k,o as F,w as D,b as i,c as u,e as t,n as g,i as p,t as h,j as $,q as M,y as _,v as W,R as q,u as P,F as O,p as z,m as I,Q as Z,l as Q,d as G}from"./_plugin-vue_export-helper.10136e75.js";import{m as J,p as X}from"./purify.es.54938489.js";import"./authStore.df4f3a65.js";const Y={class:"motd-editor"},tt={class:"card"},et={class:"card-header"},nt={class:"action-buttons"},st=["disabled"],ot={class:"card-body"},lt={key:0,class:"error-message"},it={class:"form-group switch-container"},at={class:"toggle-switch"},rt={class:"switch"},dt={class:"status-text"},ut={class:"form-group"},ct={class:"editor-wrapper"},vt={class:"toolbar"},mt=["onKeydown"],bt={class:"form-group"},ft={class:"color-themes"},pt=["onClick"],gt={class:"form-group"},yt={class:"icon-selector"},kt=["onClick"],Ct={class:"form-group"},wt={class:"display-options"},Mt={class:"option"},ht={class:"checkbox-container"},Tt={class:"option"},_t={class:"checkbox-container"},xt={class:"option"},$t={class:"checkbox-container"},Et={class:"card-footer"},St=["disabled"],Dt=["disabled"],Ot={__name:"MotdEditor",setup(c){const o=V(),s=C({...o.adminEdit}),v=k(()=>o.loading),b=k(()=>o.error),a=k(()=>o.colorThemes),m=C(o.selectedColorTheme),f=C(null),y=["info-circle","exclamation-triangle","exclamation-circle","bell","bullhorn","comment","envelope","flag","lightbulb","shield-alt"],r=k(()=>s.value.content.length),B=k(()=>s.value.content.trim().length>0&&s.value.content.length<=1e3),L=l=>({warning:"Warnung",info:"Info",success:"Erfolg",danger:"Wichtig",neutral:"Neutral"})[l]||l;F(async()=>{await o.loadMotdForEditing(),s.value={...o.adminEdit},m.value=o.selectedColorTheme}),D(()=>o.adminEdit,l=>{s.value={...l}},{deep:!0}),D(()=>o.selectedColorTheme,l=>{m.value=l});const K=l=>{m.value=l,o.applyColorTheme(l),s.value.style={...o.adminEdit.style}},N=async()=>{try{o.adminEdit={...s.value},await o.saveMotd()}catch(l){console.error("Fehler beim Speichern der MOTD:",l)}},U=()=>{o.resetMotdToDefaults(),s.value={...o.adminEdit},m.value=o.selectedColorTheme},j=async()=>{try{await o.loadMotdForEditing(),s.value={...o.adminEdit},m.value=o.selectedColorTheme}catch(l){console.error("Fehler beim Neuladen der MOTD:",l)}},w=(l,e)=>{const n=f.value;if(!n)return;const d=n.selectionStart,T=n.selectionEnd,S=s.value.content.substring(d,T),H=s.value.content.substring(0,d),R=s.value.content.substring(T);s.value.content=H+l+S+e+R,setTimeout(()=>{n.focus(),n.selectionStart=d+l.length,n.selectionEnd=d+l.length+S.length},0)},x=l=>{const e=f.value;if(!e)return;const n=e.selectionStart,d=s.value.content.substring(0,n),T=s.value.content.substring(n);s.value.content=d+l+" "+T,setTimeout(()=>{e.focus(),e.selectionStart=e.selectionEnd=n+l.length+1},0)},A=l=>{const e=f.value;if(!e)return;const n=e.selectionStart,d=e.selectionEnd;s.value.content=s.value.content.substring(0,n)+"  "+s.value.content.substring(d),setTimeout(()=>{e.focus(),e.selectionStart=e.selectionEnd=n+2},0)};return(l,e)=>(i(),u("div",Y,[t("div",tt,[t("div",et,[e[15]||(e[15]=t("h3",{class:"card-title"},"MOTD-Editor",-1)),t("div",nt,[t("button",{onClick:j,class:"action-button reload-button",disabled:v.value,title:"MOTD neu vom Server laden"},[t("i",{class:g(["fas fa-sync-alt",{"fa-spin":v.value}])},null,2)],8,st)])]),t("div",ot,[b.value?(i(),u("div",lt,[e[16]||(e[16]=t("i",{class:"fas fa-exclamation-triangle"},null,-1)),p(" "+h(b.value),1)])):$("",!0),t("div",it,[e[18]||(e[18]=t("label",{class:"switch-label"},"MOTD aktivieren",-1)),t("div",at,[t("label",rt,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=n=>s.value.enabled=n)},null,512),[[_,s.value.enabled]]),e[17]||(e[17]=t("span",{class:"slider round"},null,-1))]),t("span",dt,h(s.value.enabled?"Aktiviert":"Deaktiviert"),1)])]),t("div",ut,[e[29]||(e[29]=t("label",{for:"motdContent"},"MOTD-Inhalt (Markdown)",-1)),t("div",ct,[t("div",vt,[t("button",{type:"button",onClick:e[1]||(e[1]=n=>w("**","**")),title:"Fett"},e[19]||(e[19]=[t("i",{class:"fas fa-bold"},null,-1)])),t("button",{type:"button",onClick:e[2]||(e[2]=n=>w("*","*")),title:"Kursiv"},e[20]||(e[20]=[t("i",{class:"fas fa-italic"},null,-1)])),t("button",{type:"button",onClick:e[3]||(e[3]=n=>w("## ","")),title:"Überschrift"},e[21]||(e[21]=[t("i",{class:"fas fa-heading"},null,-1)])),t("button",{type:"button",onClick:e[4]||(e[4]=n=>w("- ","")),title:"Liste"},e[22]||(e[22]=[t("i",{class:"fas fa-list-ul"},null,-1)])),t("button",{type:"button",onClick:e[5]||(e[5]=n=>w("[","](URL)")),title:"Link"},e[23]||(e[23]=[t("i",{class:"fas fa-link"},null,-1)])),t("button",{type:"button",onClick:e[6]||(e[6]=n=>w("> ","")),title:"Zitat"},e[24]||(e[24]=[t("i",{class:"fas fa-quote-right"},null,-1)])),t("button",{type:"button",onClick:e[7]||(e[7]=n=>x("🛠️")),title:"Tool-Emoji"},e[25]||(e[25]=[t("span",null,"🛠️",-1)])),t("button",{type:"button",onClick:e[8]||(e[8]=n=>x("⚠️")),title:"Warnung-Emoji"},e[26]||(e[26]=[t("span",null,"⚠️",-1)])),t("button",{type:"button",onClick:e[9]||(e[9]=n=>x("ℹ️")),title:"Info-Emoji"},e[27]||(e[27]=[t("span",null,"ℹ️",-1)])),t("button",{type:"button",onClick:e[10]||(e[10]=n=>x("🔒")),title:"Sicherheit-Emoji"},e[28]||(e[28]=[t("span",null,"🔒",-1)]))]),M(t("textarea",{id:"motdContent","onUpdate:modelValue":e[11]||(e[11]=n=>s.value.content=n),rows:"8",class:"form-control",ref_key:"contentEditor",ref:f,onKeydown:q(P(A,["prevent"]),["tab"])},"            ",40,mt),[[W,s.value.content]])]),t("div",{class:g(["character-count",{warning:r.value>800}])},h(r.value)+" / 1000 Zeichen ",3)]),t("div",bt,[e[30]||(e[30]=t("label",null,"Farbschema",-1)),t("div",ft,[(i(!0),u(O,null,z(a.value,(n,d)=>(i(),u("button",{key:d,class:g(["color-theme-button",{active:m.value===d}]),style:I({"background-color":n.backgroundColor,"border-color":n.borderColor,color:n.textColor}),onClick:T=>K(d)},h(L(d)),15,pt))),128))])]),t("div",gt,[e[31]||(e[31]=t("label",null,"Icon",-1)),t("div",yt,[(i(),u(O,null,z(y,n=>t("button",{key:n,class:g(["icon-button",{active:s.value.style.iconClass===n}]),onClick:d=>s.value.style.iconClass=n},[t("i",{class:g(["fas",`fa-${n}`])},null,2)],10,kt)),64))])]),t("div",Ct,[e[38]||(e[38]=t("label",null,"Anzeigeoptionen",-1)),t("div",wt,[t("div",Mt,[t("label",ht,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=n=>s.value.display.dismissible=n)},null,512),[[_,s.value.display.dismissible]]),e[32]||(e[32]=t("span",{class:"checkmark"},null,-1)),e[33]||(e[33]=p(" Schließen erlauben "))])]),t("div",Tt,[t("label",_t,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=n=>s.value.display.showOnStartup=n)},null,512),[[_,s.value.display.showOnStartup]]),e[34]||(e[34]=t("span",{class:"checkmark"},null,-1)),e[35]||(e[35]=p(" Bei Start anzeigen "))])]),t("div",xt,[t("label",$t,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=n=>s.value.display.showInChat=n)},null,512),[[_,s.value.display.showInChat]]),e[36]||(e[36]=t("span",{class:"checkmark"},null,-1)),e[37]||(e[37]=p(" Im Chat anzeigen "))])])])])]),t("div",Et,[t("button",{onClick:N,class:"btn-primary save-button",disabled:v.value||!B.value},e[39]||(e[39]=[t("i",{class:"fas fa-save"},null,-1),p(" Speichern ")]),8,St),t("button",{onClick:U,class:"btn-secondary reset-button",disabled:v.value},e[40]||(e[40]=[t("i",{class:"fas fa-undo"},null,-1),p(" Zurücksetzen ")]),8,Dt)])])]))}},zt=E(Ot,[["__scopeId","data-v-7ab8fc72"]]);const Vt={class:"motd-preview"},Ft={class:"preview-header"},It={class:"preview-controls"},Bt={class:"preview-toggle"},Lt={class:"motd-inner"},Kt={key:0,class:"motd-icon"},Nt=["innerHTML"],Ut={key:1,class:"motd-close"},jt={key:1,class:"motd-disabled"},At={__name:"MotdPreview",props:{motdConfig:{type:Object,required:!0}},setup(c){const o=c,s=C(!1),v=k(()=>{if(!o.motdConfig.content)return"";try{const b=J.parse(o.motdConfig.content);return X.sanitize(b)}catch(b){return console.error("Fehler beim Rendern des Markdown-Inhalts:",b),'<p class="error">Fehler beim Rendern des Inhalts</p>'}});return(b,a)=>(i(),u("div",Vt,[t("div",Ft,[a[2]||(a[2]=t("h3",{class:"preview-title"},"Vorschau",-1)),t("div",It,[t("div",Bt,[t("label",null,[M(t("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=m=>s.value=m)},null,512),[[_,s.value]]),a[1]||(a[1]=t("span",null,"Mobile Ansicht",-1))])])])]),t("div",{class:g(["preview-container",{"mobile-view":s.value}])},[c.motdConfig.enabled?(i(),u("div",{key:0,class:g(["motd-message",{dismissible:c.motdConfig.display.dismissible}]),style:I({backgroundColor:c.motdConfig.style.backgroundColor,borderColor:c.motdConfig.style.borderColor,color:c.motdConfig.style.textColor})},[t("div",Lt,[c.motdConfig.style.iconClass?(i(),u("div",Kt,[t("i",{class:g(["fas",`fa-${c.motdConfig.style.iconClass}`])},null,2)])):$("",!0),t("div",{class:"motd-content",innerHTML:v.value},null,8,Nt),c.motdConfig.display.dismissible?(i(),u("div",Ut,a[3]||(a[3]=[t("button",{class:"close-button",title:"Schließen"},[t("i",{class:"fas fa-times"})],-1)]))):$("",!0)])],6)):(i(),u("div",jt,a[4]||(a[4]=[t("i",{class:"fas fa-eye-slash"},null,-1),t("p",null,"MOTD ist deaktiviert und wird Benutzern nicht angezeigt.",-1)])))],2)]))}},Ht=E(At,[["__scopeId","data-v-014566fb"]]);const Rt={class:"admin-sub-view"},Wt={key:0,class:"loading-indicator"},qt={key:1,class:"error-message"},Pt={key:2,class:"motd-management-container"},Zt={class:"motd-grid"},Qt={class:"editor-area"},Gt={class:"preview-area"},Jt="MOTD-Konfiguration",Xt={__name:"MotdView",setup(c){const o=V(),s=C(!0),v=C(""),b=C(0),a=k(()=>o.adminEdit),m=async()=>{s.value=!0,v.value="";try{await o.loadMotdForEditing(),b.value++}catch(y){console.error("Fehler beim Laden der MOTD-Daten:",y),v.value="Die MOTD-Konfiguration konnte nicht geladen werden. Bitte versuchen Sie es später erneut."}finally{s.value=!1}};let f=null;return F(()=>{m(),f=o.$subscribe((y,r)=>{y.type==="direct"&&y.events.key==="adminEdit"&&console.log("MOTD-Konfiguration wurde aktualisiert")})}),Z(()=>{f&&f()}),(y,r)=>(i(),u("div",Rt,[t("h1",null,h(Jt)),r[4]||(r[4]=t("p",null,"Hier können Sie die systeminterne Nachricht des Tages (MOTD) konfigurieren, die allen Benutzern angezeigt wird.",-1)),s.value?(i(),u("div",Wt,r[0]||(r[0]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),t("span",null,"Lade MOTD-Konfiguration...",-1)]))):v.value?(i(),u("div",qt,[r[2]||(r[2]=t("i",{class:"fas fa-exclamation-triangle"},null,-1)),t("span",null,h(v.value),1),t("button",{onClick:m,class:"retry-button"},r[1]||(r[1]=[t("i",{class:"fas fa-sync-alt"},null,-1),p(" Erneut versuchen ")]))])):(i(),u("div",Pt,[t("div",Zt,[t("div",Qt,[(i(),Q(zt,{key:b.value}))]),t("div",Gt,[G(Ht,{"motd-config":a.value},null,8,["motd-config"])])]),r[3]||(r[3]=t("div",{class:"motd-help"},[t("h3",null,[t("i",{class:"fas fa-info-circle"}),p(" Hinweise zur MOTD-Konfiguration ")]),t("ul",null,[t("li",null,"Die MOTD wird allen Benutzern im System angezeigt."),t("li",null,"Sie können Markdown-Formatierung verwenden, um den Text zu gestalten."),t("li",null,"Ein guter MOTD enthält wichtige aktuelle Systeminformationen, Wartungshinweise oder Neuigkeiten."),t("li",null,"Beim Speichern wird die MOTD sofort für alle Benutzer sichtbar."),t("li",null,"Achten Sie auf eine angemessene Länge - die Nachricht sollte kurz und prägnant sein.")])],-1))]))]))}},se=E(Xt,[["__scopeId","data-v-4b5a0a1e"]]);export{se as default};
//# sourceMappingURL=MotdView.82a224cf.js.map
