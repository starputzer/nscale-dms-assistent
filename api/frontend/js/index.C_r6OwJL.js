import"./chunks/modulepreload-polyfill-Dqv5PPZA.js";import{v as e,s as t}from"./chunks/uuid-util-C8eait6C.js";var n,a;document.addEventListener("DOMContentLoaded",(()=>{const e=()=>{document.querySelectorAll("form").forEach((e=>{e._preventDefaultApplied||(e.addEventListener("submit",(e=>{e.preventDefault();const t=window.__vueApp;return t&&("function"==typeof t.sendQuestionStream?t.sendQuestionStream():"function"==typeof t.sendQuestion&&t.sendQuestion()),!1}),!0),e._preventDefaultApplied=!0)}))};setTimeout(e,1e3),setInterval(e,3e3)})),"undefined"!=typeof window&&(window.uuidUtil={v4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},simple:function(){return`${(new Date).getTime().toString(36)}-${Math.random().toString(36).substring(2,10)}`},isValid:function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},fromString:function(e){let t=0;if(0===e.length)return t.toString();for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t|=0;const n=Math.abs(t).toString(16).padStart(8,"0");return`${n.substr(0,8)}-${n.substr(0,4)}-4${n.substr(0,3)}-8${n.substr(0,3)}-${"0".repeat(12)}`.substr(0,36)}}),n="telemetry",a="initialize",void 0!==window.telemetry&&window.telemetry.trackEvent("legacy_code_usage",{component:n,action:a,timestamp:(new Date).toISOString()});const i={debugMode:!1,endpoint:"/api/telemetry",maxEvents:50,flushInterval:3e4,enabled:!0,privacy:{anonymizeUserIds:!0,captureIp:!1}};let o=[],r=null;function s(){r&&clearInterval(r),r=setInterval((()=>{o.length>0&&l()}),i.flushInterval)}function c(e,t={}){if(i.enabled)try{const n=(new Date).toISOString(),a=localStorage.getItem("sessionId")||function(){const e="session_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);return localStorage.setItem("sessionId",e),e}();let r=localStorage.getItem("userId")||localStorage.getItem("abTestSessionId");i.privacy.anonymizeUserIds&&r&&(r=function(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return"user_"+Math.abs(t).toString(16)}(r));const s={eventType:e,timestamp:n,sessionId:a,userId:r,appVersion:window.appVersion||"unknown",...t};o.push(s),i.debugMode,o.length>=i.maxEvents&&l()}catch(n){}}function l(e=!1){if(i.enabled&&0!==o.length)try{const t=[...o];if(o=[],"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:t,timestamp:(new Date).toISOString()}),keepalive:!0};e?navigator.sendBeacon(i.endpoint,new Blob([JSON.stringify({events:t,timestamp:(new Date).toISOString()})],{type:"application/json"})):fetch(i.endpoint,n).catch((e=>{}))}i.debugMode}catch(t){o=[...o,...eventsToSend]}}function u(){try{localStorage.setItem("telemetryConfig",JSON.stringify({debugMode:i.debugMode,maxEvents:i.maxEvents,flushInterval:i.flushInterval,enabled:i.enabled,privacy:i.privacy}))}catch(e){}}"undefined"!=typeof window&&(window.telemetry={init:function(){try{const e=localStorage.getItem("telemetryConfig");if(e){const t=JSON.parse(e);Object.assign(i,t,{endpoint:i.endpoint}),i.debugMode}}catch(e){}return s(),window.addEventListener("beforeunload",(()=>{o.length>0&&l(!0)})),c("telemetry_initialized",{userAgent:navigator.userAgent,language:navigator.language}),i},trackEvent:c,flushEvents:l,setEnabled:function(e){return i.enabled=e,u(),e?s():r&&(clearInterval(r),r=null),i.enabled},updateConfig:function(e){return Object.assign(i,e,{endpoint:i.endpoint}),u(),s(),i}}),function(e,t){void 0!==window.telemetry&&window.telemetry.trackEvent("legacy_code_usage",{component:e,action:t,timestamp:(new Date).toISOString()})}("ab-testing","initialize");const d={"chat-interface-v2":{id:"chat-interface-v2",description:"Verbesserte Chat-OberflÃ¤che mit optimierter Nachrichtenanzeige",variants:["control","variant"],featureFlags:{control:{useSfcChat:!1,useEnhancedChat:!1},variant:{useSfcChat:!0,useEnhancedChat:!0}},eligibilityCheck:()=>!0,metrics:["messageResponseTime","userSatisfaction","sessionDuration"]},"doc-converter-batch-v2":{id:"doc-converter-batch-v2",description:"Optimierter Dokumentenkonverter mit Batch-Verarbeitung",variants:["control","variant"],featureFlags:{control:{useSfcDocConverter:!1,useVueDocConverter:!1},variant:{useSfcDocConverter:!0,useVueDocConverter:!0}},eligibilityCheck:()=>!0,metrics:["conversionSpeed","conversionSuccess","userSatisfaction"]},"admin-panel-v2":{id:"admin-panel-v2",description:"Neu gestalteter Admin-Bereich mit verbesserten Analysen",variants:["control","variant"],featureFlags:{control:{useSfcAdmin:!1},variant:{useSfcAdmin:!0}},eligibilityCheck:()=>{const e=JSON.parse(localStorage.getItem("user")||"{}");return"admin"===e.role||"super_admin"===e.role},metrics:["taskCompletionTime","navigationEfficiency","userSatisfaction"]}};let g=localStorage.getItem("abTestSessionId");function m(e){const n=localStorage.getItem("userId")||g,a=d[e];if(!a)return null;if(!a.eligibilityCheck())return null;const i=JSON.parse(localStorage.getItem("abTestAssignments")||"{}");if(i[e])return i[e];const o=a.variants,r=o[Math.floor(Math.random()*o.length)];i[e]=r,localStorage.setItem("abTestAssignments",JSON.stringify(i));const s=a.featureFlags[r];return s&&Object.entries(s).forEach((([e,n])=>{t(e,n)})),p("ab_test_assignment",{testId:e,variant:r,userId:n,timestamp:(new Date).toISOString()}),r}function f(e){return JSON.parse(localStorage.getItem("abTestAssignments")||"{}")[e]||null}function p(e,t){if(window.telemetry&&"function"==typeof window.telemetry.trackEvent)return void window.telemetry.trackEvent(e,t);const n={...t,eventType:e,appVersion:window.appVersion||"unknown",userAgent:navigator.userAgent,platform:navigator.platform};"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&fetch("/api/telemetry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0}).catch((e=>{})),localStorage.getItem("enableTelemetryDebug")}g||(g=e(),localStorage.setItem("abTestSessionId",g)),"undefined"!=typeof window&&(window.abTesting={assignUserToTest:m,getUserTestVariant:f,trackTestMetric:function(e,t,n,a={}){const i=f(e);if(!i)return;const o=d[e];o&&o.metrics.includes(t)&&p("ab_test_metric",{testId:e,variant:i,metricName:t,value:n,userId:localStorage.getItem("userId")||g,timestamp:(new Date).toISOString(),...a})},listAvailableTests:function(){return Object.values(d).map((e=>({id:e.id,description:e.description,variants:e.variants,metrics:e.metrics})))},exitTest:function(e){const t=JSON.parse(localStorage.getItem("abTestAssignments")||"{}");if(!t[e])return!1;const n=t[e];return delete t[e],localStorage.setItem("abTestAssignments",JSON.stringify(t)),p("ab_test_exit",{testId:e,variant:n,userId:localStorage.getItem("userId")||g,timestamp:(new Date).toISOString()}),!0},initializeABTests:function(){Object.keys(d).forEach((e=>{const n=f(e);if(n){const a=d[e].featureFlags[n];a&&Object.entries(a).forEach((([e,n])=>{t(e,n)}))}else m(e)})),p("ab_tests_initialized",{userId:localStorage.getItem("userId")||g,assignments:JSON.parse(localStorage.getItem("abTestAssignments")||"{}"),timestamp:(new Date).toISOString()})}});
