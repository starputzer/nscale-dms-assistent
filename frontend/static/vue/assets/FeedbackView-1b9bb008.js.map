{"version":3,"file":"FeedbackView-1b9bb008.js","sources":["../../src/stores/feedbackStore.js","../../src/components/admin/feedback/FeedbackStats.vue","../../src/components/admin/feedback/FeedbackList.vue","../../src/components/admin/feedback/FeedbackDetail.vue","../../src/views/admin/FeedbackView.vue"],"sourcesContent":["/**\n * Feedback Store für Vue.js-Implementierung\n * Verwaltet das Feedback-System und die Feedback-Daten für die Admin-Oberfläche\n */\nimport { defineStore } from 'pinia';\nimport axios from 'axios';\nimport { useAuthStore } from './authStore';\n\nexport const useFeedbackStore = defineStore('feedback', {\n  state: () => ({\n    // Feedback-Statistiken\n    stats: {\n      positive_count: 0,\n      negative_count: 0,\n      total_count: 0,\n      with_comments_count: 0,\n      timeline: []\n    },\n    \n    // Alle Feedback-Einträge\n    feedbackItems: [],\n    \n    // Aktuell ausgewähltes Feedback für Details\n    selectedFeedback: null,\n    \n    // Aktueller Filter\n    filter: {\n      type: 'all',         // 'all', 'positive', 'negative', 'with_comment'\n      dateRange: 'last7days', // 'today', 'yesterday', 'last7days', 'last30days', 'allTime'\n      search: '',\n      page: 1,\n      pageSize: 10\n    },\n    \n    // Status-Flags\n    loading: false,\n    statsLoading: false,\n    error: null,\n    \n    // Pagination\n    pagination: {\n      enabled: true,\n      currentPage: 1,\n      totalPages: 1,\n      totalItems: 0,\n      itemsPerPage: 10\n    }\n  }),\n  \n  getters: {\n    /**\n     * Gefilterte Feedback-Liste basierend auf aktuellen Filtern\n     */\n    filteredFeedback: (state) => {\n      let result = [...state.feedbackItems];\n      \n      // Filter nach Typ\n      if (state.filter.type !== 'all') {\n        if (state.filter.type === 'positive') {\n          result = result.filter(item => item.is_positive);\n        } else if (state.filter.type === 'negative') {\n          result = result.filter(item => !item.is_positive);\n        } else if (state.filter.type === 'with_comment') {\n          result = result.filter(item => item.comment && item.comment.trim().length > 0);\n        }\n      }\n      \n      // Suche\n      if (state.filter.search.trim()) {\n        const query = state.filter.search.toLowerCase();\n        result = result.filter(item => \n          (item.message_text && item.message_text.toLowerCase().includes(query)) ||\n          (item.comment && item.comment.toLowerCase().includes(query))\n        );\n      }\n      \n      return result;\n    },\n    \n    /**\n     * Prüft, ob der Store eine ausreichende Berechtigung hat\n     */\n    hasFeedbackAccess: () => {\n      const authStore = useAuthStore();\n      return authStore.canViewFeedback;\n    },\n    \n    /**\n     * Zeitraum für Überschrift formatieren\n     */\n    dateRangeFormatted: (state) => {\n      switch (state.filter.dateRange) {\n        case 'today':\n          return 'Heute';\n        case 'yesterday':\n          return 'Gestern';\n        case 'last7days':\n          return 'Letzte 7 Tage';\n        case 'last30days':\n          return 'Letzte 30 Tage';\n        case 'thisMonth':\n          return 'Dieser Monat';\n        case 'lastMonth':\n          return 'Letzter Monat';\n        case 'thisYear':\n          return 'Dieses Jahr';\n        default:\n          return 'Alle Zeiten';\n      }\n    }\n  },\n  \n  actions: {\n    /**\n     * Lädt die Feedback-Statistiken vom Server\n     * @param {string} dateRange - Zeitraum für die Statistiken\n     */\n    async loadStats(dateRange = null) {\n      if (!this.hasFeedbackAccess) return;\n      \n      this.statsLoading = true;\n      this.error = null;\n      \n      // Wenn dateRange angegeben, Filter aktualisieren\n      if (dateRange) {\n        this.filter.dateRange = dateRange;\n      }\n      \n      try {\n        const response = await axios.get('/api/admin/feedback/stats', {\n          params: {\n            date_range: this.filter.dateRange\n          }\n        });\n        \n        this.stats = response.data;\n        \n      } catch (error) {\n        console.error('Fehler beim Laden der Feedback-Statistiken:', error);\n        this.error = error.response?.data?.detail || 'Fehler beim Laden der Feedback-Statistiken';\n      } finally {\n        this.statsLoading = false;\n      }\n    },\n    \n    /**\n     * Lädt die Feedback-Liste vom Server\n     * @param {Object} options - Optionen für die Anfrage\n     */\n    async loadFeedback(options = {}) {\n      if (!this.hasFeedbackAccess) return;\n      \n      this.loading = true;\n      this.error = null;\n      \n      // Filter aktualisieren, wenn Optionen angegeben sind\n      if (options.type) this.filter.type = options.type;\n      if (options.dateRange) this.filter.dateRange = options.dateRange;\n      if (options.search !== undefined) this.filter.search = options.search;\n      if (options.page) this.filter.page = options.page;\n      \n      try {\n        const response = await axios.get('/api/admin/feedback', {\n          params: {\n            type: this.filter.type,\n            date_range: this.filter.dateRange,\n            search: this.filter.search,\n            page: this.filter.page,\n            page_size: this.filter.pageSize\n          }\n        });\n        \n        this.feedbackItems = response.data.items || [];\n        \n        // Pagination aktualisieren\n        this.pagination = {\n          enabled: true,\n          currentPage: response.data.page || 1,\n          totalPages: response.data.total_pages || 1,\n          totalItems: response.data.total_items || 0,\n          itemsPerPage: response.data.page_size || 10\n        };\n        \n      } catch (error) {\n        console.error('Fehler beim Laden der Feedback-Liste:', error);\n        this.error = error.response?.data?.detail || 'Fehler beim Laden der Feedback-Liste';\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    /**\n     * Lädt Details zu einem bestimmten Feedback-Eintrag\n     * @param {number} feedbackId - ID des Feedback-Eintrags\n     */\n    async loadFeedbackDetail(feedbackId) {\n      if (!this.hasFeedbackAccess) return;\n      \n      this.loading = true;\n      this.error = null;\n      \n      try {\n        const response = await axios.get(`/api/admin/feedback/${feedbackId}`);\n        this.selectedFeedback = response.data;\n        return response.data;\n      } catch (error) {\n        console.error('Fehler beim Laden der Feedback-Details:', error);\n        this.error = error.response?.data?.detail || 'Fehler beim Laden der Feedback-Details';\n        return null;\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    /**\n     * Lädt die Konversation zu einem Feedback\n     * @param {number} feedbackId - ID des Feedback-Eintrags\n     * @param {number} sessionId - ID der Session\n     */\n    async loadFeedbackContext(feedbackId, sessionId) {\n      if (!this.hasFeedbackAccess) return;\n      \n      this.loading = true;\n      this.error = null;\n      \n      try {\n        const response = await axios.get(`/api/admin/feedback/${feedbackId}/context`, {\n          params: {\n            session_id: sessionId\n          }\n        });\n        \n        // Wenn selectedFeedback vorhanden ist, füge Kontext hinzu\n        if (this.selectedFeedback && this.selectedFeedback.id === feedbackId) {\n          this.selectedFeedback.context_messages = response.data.messages || [];\n        }\n        \n        return response.data.messages || [];\n      } catch (error) {\n        console.error('Fehler beim Laden des Feedback-Kontexts:', error);\n        this.error = error.response?.data?.detail || 'Fehler beim Laden des Feedback-Kontexts';\n        return [];\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    /**\n     * Setzt den aktuellen Filter zurück\n     */\n    resetFilter() {\n      this.filter = {\n        type: 'all',\n        dateRange: 'last7days',\n        search: '',\n        page: 1,\n        pageSize: 10\n      };\n      \n      // Neu laden mit zurückgesetzten Filtern\n      this.loadFeedback();\n    },\n    \n    /**\n     * Wechselt die Seite der Feedback-Liste\n     * @param {number} page - Seitennummer\n     */\n    changePage(page) {\n      if (page < 1 || page > this.pagination.totalPages) return;\n      \n      this.filter.page = page;\n      this.loadFeedback();\n    },\n    \n    /**\n     * Exportiert Feedback-Daten als CSV-Datei\n     * @param {string} dateRange - Zeitraum für den Export\n     */\n    async exportFeedbackCsv(dateRange = null) {\n      if (!this.hasFeedbackAccess) return;\n      \n      this.loading = true;\n      this.error = null;\n      \n      try {\n        const params = {\n          date_range: dateRange || this.filter.dateRange,\n          type: this.filter.type !== 'all' ? this.filter.type : undefined,\n          search: this.filter.search.trim() || undefined\n        };\n        \n        const response = await axios.get('/api/admin/feedback/export', {\n          params,\n          responseType: 'blob'\n        });\n        \n        // Datei herunterladen\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement('a');\n        link.href = url;\n        \n        // Dateiname generieren\n        const date = new Date().toISOString().split('T')[0];\n        link.setAttribute('download', `feedback-export-${date}.csv`);\n        \n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        \n        return true;\n      } catch (error) {\n        console.error('Fehler beim Exportieren der Feedback-Daten:', error);\n        this.error = error.response?.data?.detail || 'Fehler beim Exportieren der Feedback-Daten';\n        return false;\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n});","<template>\n  <div class=\"feedback-stats\">\n    <div class=\"stats-header\">\n      <h2 class=\"stats-title\">{{ title }}</h2>\n      <div class=\"date-range\">\n        <span>{{ dateRangeText }}</span>\n        <button class=\"refresh-btn\" @click=\"$emit('refresh')\">\n          <i class=\"fas fa-sync-alt\"></i> Aktualisieren\n        </button>\n      </div>\n    </div>\n    \n    <div class=\"stats-grid\">\n      <!-- Total Feedback Count -->\n      <div class=\"stat-card positive\">\n        <div class=\"stat-icon\">\n          <i class=\"fas fa-comment-dots\"></i>\n        </div>\n        <div class=\"stat-data\">\n          <div class=\"stat-value\">{{ totalCount }}</div>\n          <div class=\"stat-label\">Gesamt</div>\n        </div>\n      </div>\n      \n      <!-- Positive Feedback Count -->\n      <div class=\"stat-card positive\">\n        <div class=\"stat-icon\">\n          <i class=\"fas fa-thumbs-up\"></i>\n        </div>\n        <div class=\"stat-data\">\n          <div class=\"stat-value\">{{ positiveCount }}</div>\n          <div class=\"stat-label\">Positiv</div>\n        </div>\n      </div>\n      \n      <!-- Negative Feedback Count -->\n      <div class=\"stat-card negative\">\n        <div class=\"stat-icon\">\n          <i class=\"fas fa-thumbs-down\"></i>\n        </div>\n        <div class=\"stat-data\">\n          <div class=\"stat-value\">{{ negativeCount }}</div>\n          <div class=\"stat-label\">Negativ</div>\n        </div>\n      </div>\n      \n      <!-- Feedback Rate (Positive/Total Percentage) -->\n      <div class=\"stat-card\" :class=\"feedbackRateClass\">\n        <div class=\"stat-icon\">\n          <i class=\"fas fa-chart-pie\"></i>\n        </div>\n        <div class=\"stat-data\">\n          <div class=\"stat-value\">{{ positivePercentage }}%</div>\n          <div class=\"stat-label\">Positive Rate</div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Feedback over time chart -->\n    <div class=\"chart-container\" v-if=\"showChart\">\n      <h3 class=\"chart-title\">Feedback-Trend über Zeit</h3>\n      <div class=\"chart\" ref=\"chartContainer\"></div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, watch } from 'vue';\n\n// Props\nconst props = defineProps({\n  stats: {\n    type: Object,\n    required: true\n  },\n  dateRange: {\n    type: String,\n    default: 'last7days'\n  },\n  title: {\n    type: String,\n    default: 'Feedback-Statistiken'\n  },\n  showChart: {\n    type: Boolean,\n    default: true\n  }\n});\n\n// Emits\nconst emit = defineEmits(['refresh']);\n\n// Refs\nconst chartContainer = ref(null);\n\n// Computed\nconst totalCount = computed(() => {\n  return props.stats.positive_count + props.stats.negative_count || 0;\n});\n\nconst positiveCount = computed(() => {\n  return props.stats.positive_count || 0;\n});\n\nconst negativeCount = computed(() => {\n  return props.stats.negative_count || 0;\n});\n\nconst positivePercentage = computed(() => {\n  if (totalCount.value === 0) return 0;\n  return Math.round((positiveCount.value / totalCount.value) * 100);\n});\n\nconst feedbackRateClass = computed(() => {\n  if (positivePercentage.value >= 75) return 'positive';\n  if (positivePercentage.value >= 60) return 'neutral';\n  return 'negative';\n});\n\nconst dateRangeText = computed(() => {\n  switch (props.dateRange) {\n    case 'today':\n      return 'Heute';\n    case 'yesterday':\n      return 'Gestern';\n    case 'last7days':\n      return 'Letzte 7 Tage';\n    case 'last30days':\n      return 'Letzte 30 Tage';\n    case 'thisMonth':\n      return 'Dieser Monat';\n    case 'lastMonth':\n      return 'Letzter Monat';\n    case 'thisYear':\n      return 'Dieses Jahr';\n    default:\n      return 'Alle Zeiten';\n  }\n});\n\n// Chart rendering function\nconst renderChart = () => {\n  if (!chartContainer.value || !props.stats.timeline || !props.showChart) return;\n  \n  // Here you would typically use a charting library like Chart.js or D3.js\n  // For simplicity, we'll create a basic visualization with DOM elements\n  \n  const container = chartContainer.value;\n  container.innerHTML = '';\n  \n  // Create a simple bar chart visualization\n  const timeline = props.stats.timeline || [];\n  if (timeline.length === 0) {\n    container.innerHTML = '<div class=\"no-data\">Keine Daten für die Visualisierung verfügbar</div>';\n    return;\n  }\n  \n  // Create chart structure\n  const chartEl = document.createElement('div');\n  chartEl.className = 'simple-chart';\n  \n  // Create bars for each day\n  timeline.forEach(day => {\n    const barContainer = document.createElement('div');\n    barContainer.className = 'bar-container';\n    \n    // Create positive bar\n    const positiveBar = document.createElement('div');\n    positiveBar.className = 'bar positive';\n    positiveBar.style.height = `${day.positive_count * 10}px`;\n    positiveBar.title = `${day.date}: ${day.positive_count} positive`;\n    \n    // Create negative bar\n    const negativeBar = document.createElement('div');\n    negativeBar.className = 'bar negative';\n    negativeBar.style.height = `${day.negative_count * 10}px`;\n    negativeBar.title = `${day.date}: ${day.negative_count} negative`;\n    \n    // Create date label\n    const dateLabel = document.createElement('div');\n    dateLabel.className = 'date-label';\n    dateLabel.textContent = day.date.split('-')[2]; // Just the day\n    \n    // Assemble bar\n    barContainer.appendChild(positiveBar);\n    barContainer.appendChild(negativeBar);\n    barContainer.appendChild(dateLabel);\n    \n    // Add to chart\n    chartEl.appendChild(barContainer);\n  });\n  \n  // Add the chart to the container\n  container.appendChild(chartEl);\n};\n\n// Watchers\nwatch(() => props.stats, () => {\n  renderChart();\n}, { deep: true });\n\n// Lifecycle hooks\nonMounted(() => {\n  renderChart();\n});\n</script>\n\n<style scoped>\n.feedback-stats {\n  background-color: #ffffff;\n  border-radius: 0.5rem;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.stats-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n}\n\n.stats-title {\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n}\n\n.date-range {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  color: #64748b;\n  font-size: 0.9rem;\n}\n\n.refresh-btn {\n  background-color: #f1f5f9;\n  border: none;\n  padding: 0.4rem 0.75rem;\n  border-radius: 0.375rem;\n  font-size: 0.85rem;\n  color: #475569;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n}\n\n.refresh-btn:hover {\n  background-color: #e2e8f0;\n  color: #334155;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.stat-card {\n  background-color: #f8fafc;\n  border-radius: 0.5rem;\n  padding: 1.25rem;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.stat-card.positive {\n  background-color: #f0fdf4;\n  border-left: 4px solid #22c55e;\n}\n\n.stat-card.neutral {\n  background-color: #f8fafc;\n  border-left: 4px solid #3b82f6;\n}\n\n.stat-card.negative {\n  background-color: #fef2f2;\n  border-left: 4px solid #ef4444;\n}\n\n.stat-icon {\n  background-color: rgba(255, 255, 255, 0.7);\n  width: 3rem;\n  height: 3rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  border-radius: 50%;\n  color: #64748b;\n}\n\n.stat-card.positive .stat-icon {\n  color: #22c55e;\n}\n\n.stat-card.negative .stat-icon {\n  color: #ef4444;\n}\n\n.stat-data {\n  display: flex;\n  flex-direction: column;\n}\n\n.stat-value {\n  font-size: 1.75rem;\n  font-weight: 700;\n  color: #1e293b;\n  line-height: 1;\n}\n\n.stat-label {\n  color: #64748b;\n  font-size: 0.875rem;\n  margin-top: 0.25rem;\n}\n\n.chart-container {\n  margin-top: 2rem;\n  padding-top: 1.5rem;\n  border-top: 1px solid #e2e8f0;\n}\n\n.chart-title {\n  font-size: 1rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin-bottom: 1rem;\n}\n\n.chart {\n  height: 200px;\n  background-color: #f8fafc;\n  border-radius: 0.375rem;\n  padding: 1rem;\n}\n\n/* Simple chart styles */\n.simple-chart {\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-around;\n  height: 100%;\n  gap: 0.25rem;\n  padding-bottom: 1.5rem;\n}\n\n.bar-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n  position: relative;\n  flex: 1;\n}\n\n.bar {\n  width: 1rem;\n  margin: 0 0.25rem;\n  transition: height 0.3s ease;\n}\n\n.bar.positive {\n  background-color: #22c55e;\n  margin-bottom: 0.125rem;\n}\n\n.bar.negative {\n  background-color: #ef4444;\n}\n\n.date-label {\n  position: absolute;\n  bottom: -1.5rem;\n  font-size: 0.75rem;\n  color: #64748b;\n}\n\n.no-data {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: #94a3b8;\n  font-style: italic;\n}\n\n/* Dark Mode Support */\n:global(.theme-dark) .feedback-stats {\n  background-color: #1e1e1e;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n}\n\n:global(.theme-dark) .stats-title {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .date-range {\n  color: #aaa;\n}\n\n:global(.theme-dark) .refresh-btn {\n  background-color: #252525;\n  color: #bbb;\n}\n\n:global(.theme-dark) .refresh-btn:hover {\n  background-color: #333;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .stat-card {\n  background-color: #252525;\n}\n\n:global(.theme-dark) .stat-card.positive {\n  background-color: #133929;\n  border-left-color: #22c55e;\n}\n\n:global(.theme-dark) .stat-card.neutral {\n  background-color: #1a365d;\n  border-left-color: #3b82f6;\n}\n\n:global(.theme-dark) .stat-card.negative {\n  background-color: #4c1d24;\n  border-left-color: #ef4444;\n}\n\n:global(.theme-dark) .stat-icon {\n  background-color: rgba(255, 255, 255, 0.1);\n  color: #aaa;\n}\n\n:global(.theme-dark) .stat-card.positive .stat-icon {\n  color: #4ade80;\n}\n\n:global(.theme-dark) .stat-card.negative .stat-icon {\n  color: #f87171;\n}\n\n:global(.theme-dark) .stat-value {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .stat-label {\n  color: #aaa;\n}\n\n:global(.theme-dark) .chart-container {\n  border-top-color: #333;\n}\n\n:global(.theme-dark) .chart-title {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .chart {\n  background-color: #252525;\n}\n\n:global(.theme-dark) .bar.positive {\n  background-color: #4ade80;\n}\n\n:global(.theme-dark) .bar.negative {\n  background-color: #f87171;\n}\n\n:global(.theme-dark) .date-label {\n  color: #aaa;\n}\n\n:global(.theme-dark) .no-data {\n  color: #777;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .stats-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n  \n  .stats-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.75rem;\n  }\n  \n  .chart {\n    height: 150px;\n  }\n}\n\n@media (max-width: 480px) {\n  .stats-grid {\n    grid-template-columns: 1fr;\n  }\n}\n</style>","<template>\n  <div class=\"feedback-list\">\n    <div class=\"list-header\">\n      <h2 class=\"list-title\">{{ title }}</h2>\n      <div class=\"filter-controls\">\n        <!-- Filter by feedback type -->\n        <div class=\"filter-select\">\n          <select v-model=\"activeFilter\" @change=\"applyFilters\">\n            <option value=\"all\">Alle</option>\n            <option value=\"positive\">Positiv</option>\n            <option value=\"negative\">Negativ</option>\n            <option value=\"with_comment\">Mit Kommentar</option>\n          </select>\n        </div>\n        \n        <!-- Search input -->\n        <div class=\"search-box\">\n          <input \n            type=\"text\" \n            v-model=\"searchQuery\" \n            placeholder=\"Suche...\" \n            @input=\"applyFilters\"\n          />\n          <i class=\"fas fa-search\"></i>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Loading indicator -->\n    <div v-if=\"loading\" class=\"loading-container\">\n      <div class=\"loader\"></div>\n      <span>Feedback wird geladen...</span>\n    </div>\n    \n    <!-- Empty state -->\n    <div v-else-if=\"filteredFeedback.length === 0\" class=\"empty-state\">\n      <i class=\"fas fa-comment-slash\"></i>\n      <p>{{ emptyStateMessage }}</p>\n      <button \n        v-if=\"hasActiveFilters\" \n        class=\"reset-filters-btn\" \n        @click=\"resetFilters\"\n      >\n        Filter zurücksetzen\n      </button>\n    </div>\n    \n    <!-- Feedback items -->\n    <div v-else class=\"feedback-items\">\n      <div \n        v-for=\"feedback in filteredFeedback\" \n        :key=\"feedback.id\" \n        class=\"feedback-item\"\n        :class=\"{\n          'positive': feedback.is_positive,\n          'negative': !feedback.is_positive,\n          'with-comment': !!feedback.comment\n        }\"\n      >\n        <div class=\"feedback-header\">\n          <div class=\"feedback-badge\" :class=\"feedback.is_positive ? 'positive' : 'negative'\">\n            <i :class=\"[\n              'fas', \n              feedback.is_positive ? 'fa-thumbs-up' : 'fa-thumbs-down'\n            ]\"></i>\n          </div>\n          <div class=\"feedback-meta\">\n            <div class=\"feedback-session\">\n              Session: <span class=\"session-id\">{{ feedback.session_id }}</span>\n            </div>\n            <div class=\"feedback-time\">\n              {{ formatDate(feedback.created_at) }}\n            </div>\n          </div>\n          <div class=\"feedback-actions\">\n            <button \n              class=\"action-btn view-btn\" \n              title=\"Nachricht anzeigen\"\n              @click=\"$emit('view-message', feedback)\"\n            >\n              <i class=\"fas fa-eye\"></i>\n            </button>\n            <button \n              class=\"action-btn view-session-btn\" \n              title=\"Session ansehen\"\n              @click=\"$emit('view-session', feedback.session_id)\"\n            >\n              <i class=\"fas fa-comments\"></i>\n            </button>\n          </div>\n        </div>\n        \n        <div v-if=\"feedback.comment\" class=\"feedback-comment\">\n          <span class=\"comment-label\">Kommentar:</span>\n          <p class=\"comment-text\">{{ feedback.comment }}</p>\n        </div>\n        \n        <!-- Antwort Vorschau -->\n        <div class=\"feedback-message\">\n          <div class=\"message-meta-label\">Assistenten-Antwort:</div>\n          <div class=\"message-preview\" :class=\"{ 'expanded': expandedItems[feedback.id] }\">\n            {{ truncateMessage(feedback.answer || feedback.message_text) }}\n          </div>\n          <button \n            v-if=\"shouldShowExpandButton(feedback.answer || feedback.message_text)\" \n            class=\"expand-btn\"\n            @click=\"toggleExpand(feedback.id)\"\n          >\n            {{ expandedItems[feedback.id] ? 'Weniger anzeigen' : 'Mehr anzeigen' }}\n          </button>\n        </div>\n        \n        <!-- Frage Vorschau (falls vorhanden) -->\n        <div v-if=\"feedback.question\" class=\"feedback-question\">\n          <div class=\"message-meta-label\">Ursprüngliche Frage:</div>\n          <div class=\"question-preview\" :class=\"{ 'expanded': expandedItemsQuestion[feedback.id] }\">\n            {{ truncateMessage(feedback.question) }}\n          </div>\n          <button \n            v-if=\"shouldShowExpandButton(feedback.question)\" \n            class=\"expand-btn\"\n            @click=\"toggleExpandQuestion(feedback.id)\"\n          >\n            {{ expandedItemsQuestion[feedback.id] ? 'Weniger anzeigen' : 'Mehr anzeigen' }}\n          </button>\n        </div>\n      </div>\n      \n      <!-- Pagination controls -->\n      <div v-if=\"hasPagination\" class=\"pagination-controls\">\n        <button \n          class=\"pagination-btn prev-btn\" \n          :disabled=\"currentPage === 1\"\n          @click=\"changePage(currentPage - 1)\"\n        >\n          <i class=\"fas fa-chevron-left\"></i>\n          Zurück\n        </button>\n        \n        <div class=\"pagination-info\">\n          Seite {{ currentPage }} von {{ totalPages }}\n        </div>\n        \n        <button \n          class=\"pagination-btn next-btn\" \n          :disabled=\"currentPage === totalPages\"\n          @click=\"changePage(currentPage + 1)\"\n        >\n          Weiter\n          <i class=\"fas fa-chevron-right\"></i>\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue';\n\n// Props\nconst props = defineProps({\n  feedbackItems: {\n    type: Array,\n    default: () => []\n  },\n  loading: {\n    type: Boolean,\n    default: false\n  },\n  title: {\n    type: String,\n    default: 'Feedback'\n  },\n  pagination: {\n    type: Object,\n    default: () => ({ \n      enabled: false, \n      itemsPerPage: 10, \n      currentPage: 1, \n      totalPages: 1 \n    })\n  }\n});\n\n// Emits\nconst emit = defineEmits([\n  'view-message', \n  'view-session', \n  'filter-change',\n  'search-change',\n  'page-change'\n]);\n\n// Local state\nconst activeFilter = ref('all');\nconst searchQuery = ref('');\nconst expandedItems = ref({});\nconst expandedItemsQuestion = ref({});\nconst currentPage = ref(props.pagination?.currentPage || 1);\n\n// Computed properties\nconst filteredFeedback = computed(() => {\n  let result = [...props.feedbackItems];\n  \n  // Apply filter\n  if (activeFilter.value !== 'all') {\n    if (activeFilter.value === 'positive') {\n      result = result.filter(item => item.is_positive);\n    } else if (activeFilter.value === 'negative') {\n      result = result.filter(item => !item.is_positive);\n    } else if (activeFilter.value === 'with_comment') {\n      result = result.filter(item => item.comment && item.comment.trim().length > 0);\n    }\n  }\n  \n  // Apply search\n  if (searchQuery.value.trim()) {\n    const query = searchQuery.value.toLowerCase();\n    result = result.filter(item => \n      (item.message_text && item.message_text.toLowerCase().includes(query)) ||\n      (item.comment && item.comment.toLowerCase().includes(query))\n    );\n  }\n  \n  return result;\n});\n\nconst hasActiveFilters = computed(() => {\n  return activeFilter.value !== 'all' || searchQuery.value.trim() !== '';\n});\n\nconst emptyStateMessage = computed(() => {\n  if (hasActiveFilters.value) {\n    return 'Keine passenden Feedback-Einträge gefunden.';\n  }\n  return 'Noch kein Feedback vorhanden.';\n});\n\nconst hasPagination = computed(() => {\n  return props.pagination && props.pagination.enabled;\n});\n\nconst totalPages = computed(() => {\n  return props.pagination?.totalPages || 1;\n});\n\n// Methods\nconst applyFilters = () => {\n  emit('filter-change', activeFilter.value);\n  emit('search-change', searchQuery.value);\n  \n  // Reset to first page when filters change\n  if (hasPagination.value && currentPage.value !== 1) {\n    currentPage.value = 1;\n    emit('page-change', 1);\n  }\n};\n\nconst resetFilters = () => {\n  activeFilter.value = 'all';\n  searchQuery.value = '';\n  applyFilters();\n};\n\nconst changePage = (page) => {\n  currentPage.value = page;\n  emit('page-change', page);\n};\n\nconst toggleExpand = (feedbackId) => {\n  expandedItems.value = {\n    ...expandedItems.value,\n    [feedbackId]: !expandedItems.value[feedbackId]\n  };\n};\n\nconst toggleExpandQuestion = (feedbackId) => {\n  expandedItemsQuestion.value = {\n    ...expandedItemsQuestion.value,\n    [feedbackId]: !expandedItemsQuestion.value[feedbackId]\n  };\n};\n\nconst truncateMessage = (message) => {\n  if (!message) return '';\n  \n  // If already expanded, show full message\n  if (expandedItems.value[message.id]) {\n    return message;\n  }\n  \n  // Otherwise truncate to 150 characters\n  if (message.length > 150) {\n    return message.substring(0, 150) + '...';\n  }\n  \n  return message;\n};\n\nconst shouldShowExpandButton = (message) => {\n  return message && message.length > 150;\n};\n\nconst formatDate = (dateString) => {\n  if (!dateString) return '';\n  \n  const date = new Date(dateString);\n  return date.toLocaleString('de-DE', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n};\n\n// Watch for changes in pagination from parent\nwatch(() => props.pagination, (newVal) => {\n  if (newVal && newVal.currentPage) {\n    currentPage.value = newVal.currentPage;\n  }\n}, { deep: true });\n</script>\n\n<style scoped>\n.feedback-list {\n  background-color: #ffffff;\n  border-radius: 0.5rem;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  padding: 1.5rem;\n}\n\n.list-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.list-title {\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n}\n\n.filter-controls {\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n}\n\n.filter-select select {\n  padding: 0.5rem 2rem 0.5rem 1rem;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  background-color: #f8fafc;\n  font-size: 0.875rem;\n  color: #475569;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 0.5rem center;\n  background-size: 1.25rem;\n}\n\n.search-box {\n  position: relative;\n}\n\n.search-box input {\n  padding: 0.5rem 2.5rem 0.5rem 1rem;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  background-color: #f8fafc;\n  font-size: 0.875rem;\n  color: #475569;\n  width: 200px;\n}\n\n.search-box i {\n  position: absolute;\n  right: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #94a3b8;\n  pointer-events: none;\n}\n\n.loading-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  color: #64748b;\n}\n\n.loader {\n  border: 3px solid #f3f3f3;\n  border-top: 3px solid #3b82f6;\n  border-radius: 50%;\n  width: 2rem;\n  height: 2rem;\n  animation: spin 1s linear infinite;\n  margin-bottom: 1rem;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem;\n  text-align: center;\n  color: #64748b;\n}\n\n.empty-state i {\n  font-size: 3rem;\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n\n.reset-filters-btn {\n  margin-top: 1rem;\n  padding: 0.5rem 1rem;\n  background-color: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  color: #475569;\n  font-size: 0.875rem;\n  cursor: pointer;\n}\n\n.reset-filters-btn:hover {\n  background-color: #f1f5f9;\n}\n\n.feedback-items {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.feedback-item {\n  border: 1px solid #e2e8f0;\n  border-radius: 0.5rem;\n  overflow: hidden;\n}\n\n.feedback-item.positive {\n  border-left: 4px solid #22c55e;\n}\n\n.feedback-item.negative {\n  border-left: 4px solid #ef4444;\n}\n\n.feedback-header {\n  padding: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  background-color: #f8fafc;\n}\n\n.feedback-badge {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 2.5rem;\n  height: 2.5rem;\n  border-radius: 50%;\n  color: white;\n  flex-shrink: 0;\n}\n\n.feedback-badge.positive {\n  background-color: #22c55e;\n}\n\n.feedback-badge.negative {\n  background-color: #ef4444;\n}\n\n.feedback-meta {\n  flex-grow: 1;\n}\n\n.feedback-session {\n  font-size: 0.875rem;\n  color: #64748b;\n  margin-bottom: 0.25rem;\n}\n\n.session-id {\n  font-family: monospace;\n  font-weight: 500;\n}\n\n.feedback-time {\n  font-size: 0.75rem;\n  color: #94a3b8;\n}\n\n.feedback-actions {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.action-btn {\n  background: none;\n  border: none;\n  padding: 0.375rem;\n  border-radius: 0.25rem;\n  color: #64748b;\n  cursor: pointer;\n}\n\n.action-btn:hover {\n  background-color: #e2e8f0;\n  color: #1e293b;\n}\n\n.feedback-comment {\n  padding: 1rem;\n  background-color: #fffbeb;\n  border-bottom: 1px solid #fef3c7;\n}\n\n.comment-label {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: #d97706;\n  display: block;\n  margin-bottom: 0.25rem;\n}\n\n.comment-text {\n  margin: 0;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #92400e;\n}\n\n.feedback-message {\n  padding: 1rem;\n}\n\n.message-meta-label {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: #64748b;\n  margin-bottom: 0.25rem;\n}\n\n.message-preview, .question-preview {\n  font-size: 0.875rem;\n  line-height: 1.6;\n  color: #334155;\n  white-space: pre-line;\n  max-height: 4.8rem;\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n}\n\n.message-preview.expanded, .question-preview.expanded {\n  max-height: none;\n}\n\n.feedback-question {\n  padding: 1rem;\n  background-color: #e0f2fe;\n  border-top: 1px solid #bae6fd;\n}\n\n.question-preview {\n  color: #0369a1;\n}\n\n.expand-btn {\n  background: none;\n  border: none;\n  padding: 0;\n  margin-top: 0.5rem;\n  font-size: 0.75rem;\n  color: #3b82f6;\n  cursor: pointer;\n}\n\n.expand-btn:hover {\n  text-decoration: underline;\n}\n\n.pagination-controls {\n  margin-top: 1.5rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-top: 1px solid #e2e8f0;\n  padding-top: 1rem;\n}\n\n.pagination-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  background-color: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  color: #475569;\n  font-size: 0.875rem;\n  cursor: pointer;\n}\n\n.pagination-btn:hover:not(:disabled) {\n  background-color: #f1f5f9;\n}\n\n.pagination-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.pagination-info {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n\n/* Dark Mode Support */\n:global(.theme-dark) .feedback-list {\n  background-color: #1e1e1e;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n}\n\n:global(.theme-dark) .list-title {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .filter-select select {\n  background-color: #252525;\n  border-color: #444;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .search-box input {\n  background-color: #252525;\n  border-color: #444;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .search-box i {\n  color: #777;\n}\n\n:global(.theme-dark) .loading-container {\n  color: #bbb;\n}\n\n:global(.theme-dark) .loader {\n  border-color: #333;\n  border-top-color: #3b82f6;\n}\n\n:global(.theme-dark) .empty-state {\n  color: #aaa;\n}\n\n:global(.theme-dark) .reset-filters-btn {\n  background-color: #252525;\n  border-color: #444;\n  color: #bbb;\n}\n\n:global(.theme-dark) .reset-filters-btn:hover {\n  background-color: #333;\n}\n\n:global(.theme-dark) .feedback-item {\n  border-color: #333;\n}\n\n:global(.theme-dark) .feedback-header {\n  background-color: #252525;\n}\n\n:global(.theme-dark) .feedback-session {\n  color: #bbb;\n}\n\n:global(.theme-dark) .feedback-time {\n  color: #777;\n}\n\n:global(.theme-dark) .action-btn {\n  color: #bbb;\n}\n\n:global(.theme-dark) .action-btn:hover {\n  background-color: #333;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .feedback-comment {\n  background-color: #332711;\n  border-bottom-color: #443b11;\n}\n\n:global(.theme-dark) .comment-text {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .feedback-message {\n  background-color: #1e1e1e;\n}\n\n:global(.theme-dark) .message-preview, \n:global(.theme-dark) .question-preview {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .message-meta-label {\n  color: #aaa;\n}\n\n:global(.theme-dark) .feedback-question {\n  background-color: #163850;\n  border-top-color: #1e4a6c;\n}\n\n:global(.theme-dark) .question-preview {\n  color: #81c5f8;\n}\n\n:global(.theme-dark) .expand-btn {\n  color: #5c9be0;\n}\n\n:global(.theme-dark) .pagination-controls {\n  border-top-color: #333;\n}\n\n:global(.theme-dark) .pagination-btn {\n  background-color: #252525;\n  border-color: #444;\n  color: #bbb;\n}\n\n:global(.theme-dark) .pagination-btn:hover:not(:disabled) {\n  background-color: #333;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .pagination-info {\n  color: #bbb;\n}\n\n/* Kontrast-Modus Unterstützung */\n:global(.theme-contrast) .message-meta-label {\n  color: #ffeb3b;\n  font-weight: bold;\n}\n\n:global(.theme-contrast) .feedback-question {\n  background-color: #003566;\n  border-color: #0066cc;\n}\n\n:global(.theme-contrast) .question-preview {\n  color: #66ccff;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .list-header {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  \n  .filter-controls {\n    width: 100%;\n    flex-wrap: wrap;\n  }\n  \n  .search-box input {\n    width: 100%;\n  }\n  \n  .feedback-header {\n    flex-wrap: wrap;\n  }\n}\n</style>","<template>\n  <div class=\"feedback-detail\" :class=\"{ 'expanded': expanded }\">\n    <div class=\"feedback-header\">\n      <div class=\"feedback-title\">\n        <div class=\"feedback-badge\" :class=\"feedbackType\">\n          <i :class=\"[\n            'fas', \n            isPositive ? 'fa-thumbs-up' : 'fa-thumbs-down'\n          ]\"></i>\n        </div>\n        <h3>Feedback-Details</h3>\n      </div>\n      \n      <div class=\"feedback-actions\">\n        <button \n          class=\"action-btn toggle-btn\" \n          @click=\"toggleExpanded\"\n          :title=\"expanded ? 'Minimieren' : 'Maximieren'\"\n        >\n          <i :class=\"['fas', expanded ? 'fa-compress-alt' : 'fa-expand-alt']\"></i>\n        </button>\n        <button class=\"action-btn close-btn\" @click=\"$emit('close')\" title=\"Schließen\">\n          <i class=\"fas fa-times\"></i>\n        </button>\n      </div>\n    </div>\n    \n    <div class=\"feedback-content\">\n      <div class=\"detail-section\">\n        <div class=\"detail-grid\">\n          <!-- Session info -->\n          <div class=\"detail-item\">\n            <div class=\"detail-label\">Session-ID</div>\n            <div class=\"detail-value\">\n              <span class=\"monospace\">{{ feedback.session_id }}</span>\n              <button \n                class=\"link-btn\" \n                @click=\"$emit('view-session', feedback.session_id)\"\n              >\n                <i class=\"fas fa-external-link-alt\"></i>\n                Session öffnen\n              </button>\n            </div>\n          </div>\n          \n          <!-- Date -->\n          <div class=\"detail-item\">\n            <div class=\"detail-label\">Datum & Zeit</div>\n            <div class=\"detail-value\">\n              {{ formatDate(feedback.created_at) }}\n            </div>\n          </div>\n          \n          <!-- Type -->\n          <div class=\"detail-item\">\n            <div class=\"detail-label\">Feedback-Typ</div>\n            <div class=\"detail-value status-badge\" :class=\"feedbackType\">\n              <i :class=\"[\n                'fas', \n                isPositive ? 'fa-thumbs-up' : 'fa-thumbs-down'\n              ]\"></i>\n              {{ isPositive ? 'Positiv' : 'Negativ' }}\n            </div>\n          </div>\n          \n          <!-- User -->\n          <div class=\"detail-item\">\n            <div class=\"detail-label\">Benutzer</div>\n            <div class=\"detail-value\">\n              {{ feedback.user_email || 'Anonym' }}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Comment section -->\n      <div v-if=\"feedback.comment\" class=\"detail-section comment-section\">\n        <h4>Benutzerkommentar</h4>\n        <div class=\"comment-content\">{{ feedback.comment }}</div>\n      </div>\n      \n      <!-- Question section -->\n      <div v-if=\"feedback.question\" class=\"detail-section question-section\">\n        <h4>Ursprüngliche Frage</h4>\n        <div class=\"question-content\">{{ feedback.question }}</div>\n      </div>\n      \n      <!-- Answer section -->\n      <div v-if=\"feedback.answer || feedback.message_text\" class=\"detail-section\">\n        <h4>Assistenten-Antwort</h4>\n        <ContentRenderer \n          class=\"message-content\" \n          type=\"markdown\" \n          :content=\"feedback.answer || feedback.message_text\"\n        />\n      </div>\n      \n      <!-- Context messages -->\n      <div v-if=\"feedback.context_messages && feedback.context_messages.length > 0\" class=\"detail-section\">\n        <h4>Konversationsverlauf</h4>\n        <div class=\"context-messages\">\n          <div \n            v-for=\"(message, index) in feedback.context_messages\" \n            :key=\"index\"\n            class=\"context-message\"\n            :class=\"{ 'user-message': message.is_user }\"\n          >\n            <div class=\"message-header\">\n              <span class=\"message-author\">\n                {{ message.is_user ? 'Benutzer' : 'Assistent' }}\n              </span>\n              <span class=\"message-time\">\n                {{ formatDate(message.created_at) }}\n              </span>\n            </div>\n            <ContentRenderer class=\"message-text\" type=\"markdown\" :content=\"message.message\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue';\nimport ContentRenderer from '@/components/common/ContentRenderer.vue';\n\n// Props\nconst props = defineProps({\n  feedback: {\n    type: Object,\n    required: true\n  },\n  initialExpanded: {\n    type: Boolean,\n    default: false\n  }\n});\n\n// Emits\nconst emit = defineEmits(['close', 'view-session']);\n\n// State\nconst expanded = ref(props.initialExpanded);\n\n// Computed\nconst isPositive = computed(() => {\n  return props.feedback.is_positive;\n});\n\nconst feedbackType = computed(() => {\n  return isPositive.value ? 'positive' : 'negative';\n});\n\n// Methods\nconst toggleExpanded = () => {\n  expanded.value = !expanded.value;\n};\n\nconst formatDate = (dateString) => {\n  if (!dateString) return '';\n  \n  const date = new Date(dateString);\n  return date.toLocaleString('de-DE', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit'\n  });\n};\n\n// Removed formatMessage function - now using ContentRenderer component\n</script>\n\n<style scoped>\n.feedback-detail {\n  background-color: white;\n  border-radius: 0.5rem;\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n  display: flex;\n  flex-direction: column;\n  max-width: 800px;\n  width: 100%;\n  max-height: 70vh;\n  transition: all 0.3s ease;\n}\n\n.feedback-detail.expanded {\n  position: fixed;\n  top: 2rem;\n  left: 2rem;\n  right: 2rem;\n  bottom: 2rem;\n  max-width: none;\n  max-height: none;\n  width: auto;\n  height: auto;\n  z-index: 1000;\n}\n\n.feedback-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.feedback-title {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.feedback-title h3 {\n  margin: 0;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #1e293b;\n}\n\n.feedback-badge {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 2rem;\n  height: 2rem;\n  border-radius: 50%;\n  color: white;\n  flex-shrink: 0;\n}\n\n.feedback-badge.positive {\n  background-color: #22c55e;\n}\n\n.feedback-badge.negative {\n  background-color: #ef4444;\n}\n\n.feedback-actions {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.action-btn {\n  background: none;\n  border: none;\n  padding: 0.375rem;\n  border-radius: 0.25rem;\n  color: #64748b;\n  cursor: pointer;\n}\n\n.action-btn:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.close-btn:hover {\n  background-color: #fee2e2;\n  color: #b91c1c;\n}\n\n.feedback-content {\n  padding: 1.5rem;\n  overflow-y: auto;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n.detail-section {\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  overflow: hidden;\n}\n\n.detail-section h4 {\n  margin: 0;\n  padding: 1rem;\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: #475569;\n  background-color: #f8fafc;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.detail-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 1rem;\n  padding: 1rem;\n}\n\n.detail-item {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.detail-label {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: #64748b;\n}\n\n.detail-value {\n  font-size: 0.875rem;\n  color: #334155;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.monospace {\n  font-family: monospace;\n  font-size: 0.9rem;\n}\n\n.link-btn {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.25rem;\n  font-size: 0.75rem;\n  color: #3b82f6;\n  background: none;\n  border: none;\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.25rem;\n  cursor: pointer;\n}\n\n.link-btn:hover {\n  background-color: #eff6ff;\n  text-decoration: underline;\n}\n\n.status-badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.375rem;\n  padding: 0.25rem 0.625rem;\n  border-radius: 1rem;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n\n.status-badge.positive {\n  background-color: #dcfce7;\n  color: #166534;\n}\n\n.status-badge.negative {\n  background-color: #fee2e2;\n  color: #b91c1c;\n}\n\n.comment-content {\n  padding: 1rem;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #334155;\n  background-color: #fffbeb;\n  white-space: pre-line;\n}\n\n.question-content {\n  padding: 1rem;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #334155;\n  background-color: #e0f2fe;\n  white-space: pre-line;\n}\n\n.message-content {\n  padding: 1rem;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #334155;\n  white-space: pre-line;\n}\n\n.context-messages {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  max-height: 350px;\n  overflow-y: auto;\n}\n\n.context-message {\n  padding: 1rem;\n  border-radius: 0.375rem;\n  background-color: #f1f5f9;\n}\n\n.context-message.user-message {\n  background-color: #e0f2fe;\n}\n\n.message-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n  font-size: 0.75rem;\n}\n\n.message-author {\n  font-weight: 600;\n  color: #475569;\n}\n\n.message-time {\n  color: #64748b;\n}\n\n.message-text {\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #334155;\n  white-space: pre-line;\n}\n\n/* Allow HTML rendering from the markdown formatting */\n:deep(.message-content a) {\n  color: #3b82f6;\n  text-decoration: underline;\n}\n\n:deep(.message-content ul),\n:deep(.message-content ol) {\n  padding-left: 1.5rem;\n}\n\n:deep(.message-content code) {\n  font-family: monospace;\n  background-color: #f1f5f9;\n  padding: 0.125rem 0.25rem;\n  border-radius: 0.25rem;\n}\n\n:deep(.message-content pre) {\n  background-color: #1e293b;\n  color: #f8fafc;\n  padding: 1rem;\n  border-radius: 0.375rem;\n  overflow-x: auto;\n}\n\n:deep(.message-text a),\n:deep(.message-text code),\n:deep(.message-text pre) {\n  /* Same styling as message-content */\n  font-family: inherit;\n}\n\n/* Dark Mode Support */\n:global(.theme-dark) .feedback-detail {\n  background-color: #1e1e1e;\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);\n}\n\n:global(.theme-dark) .feedback-header {\n  border-bottom-color: #333;\n}\n\n:global(.theme-dark) .feedback-title h3 {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .action-btn {\n  color: #aaa;\n}\n\n:global(.theme-dark) .action-btn:hover {\n  background-color: #333;\n  color: #fff;\n}\n\n:global(.theme-dark) .close-btn:hover {\n  background-color: #661a1a;\n  color: #fff;\n}\n\n:global(.theme-dark) .detail-section {\n  border-color: #333;\n}\n\n:global(.theme-dark) .detail-section h4 {\n  background-color: #252525;\n  color: #e0e0e0;\n  border-bottom-color: #333;\n}\n\n:global(.theme-dark) .detail-label {\n  color: #bbb;\n}\n\n:global(.theme-dark) .detail-value {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .link-btn {\n  color: #5c9be0;\n}\n\n:global(.theme-dark) .link-btn:hover {\n  background-color: #253851;\n}\n\n:global(.theme-dark) .status-badge.positive {\n  background-color: #133929;\n  color: #4ade80;\n}\n\n:global(.theme-dark) .status-badge.negative {\n  background-color: #4c1818;\n  color: #f87171;\n}\n\n:global(.theme-dark) .comment-content {\n  background-color: #332711;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .question-content {\n  background-color: #163850;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .message-content,\n:global(.theme-dark) .message-text {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .context-message {\n  background-color: #252525;\n}\n\n:global(.theme-dark) .context-message.user-message {\n  background-color: #163850;\n}\n\n:global(.theme-dark) .message-author {\n  color: #bbb;\n}\n\n:global(.theme-dark) .message-time {\n  color: #999;\n}\n\n:global(.theme-dark) :deep(.message-content a),\n:global(.theme-dark) :deep(.message-text a) {\n  color: #5c9be0;\n}\n\n:global(.theme-dark) :deep(.message-content code),\n:global(.theme-dark) :deep(.message-text code) {\n  background-color: #252525;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) :deep(.message-content pre),\n:global(.theme-dark) :deep(.message-text pre) {\n  background-color: #111827;\n  color: #f9fafb;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .detail-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .feedback-detail.expanded {\n    top: 0.5rem;\n    left: 0.5rem;\n    right: 0.5rem;\n    bottom: 0.5rem;\n  }\n}\n</style>","<template>\n  <div class=\"admin-feedback-view\">\n    <div class=\"page-header\">\n      <h1 class=\"page-title\">Feedback-Analyse</h1>\n      <div class=\"header-actions\">\n        <!-- Date range selector -->\n        <div class=\"date-range-selector\">\n          <label for=\"date-range\" class=\"selector-label\">Zeitraum:</label>\n          <select \n            id=\"date-range\" \n            v-model=\"selectedDateRange\"\n            @change=\"handleDateRangeChange\"\n            class=\"date-range-select\"\n          >\n            <option value=\"today\">Heute</option>\n            <option value=\"yesterday\">Gestern</option>\n            <option value=\"last7days\">Letzte 7 Tage</option>\n            <option value=\"last30days\">Letzte 30 Tage</option>\n            <option value=\"thisMonth\">Dieser Monat</option>\n            <option value=\"lastMonth\">Letzter Monat</option>\n            <option value=\"thisYear\">Dieses Jahr</option>\n            <option value=\"allTime\">Alle Zeit</option>\n          </select>\n        </div>\n        \n        <!-- Export button -->\n        <button \n          @click=\"exportFeedback\" \n          class=\"export-btn\"\n          :disabled=\"loading\"\n        >\n          <i class=\"fas fa-file-export\"></i>\n          Exportieren (CSV)\n        </button>\n        \n        <!-- Refresh button -->\n        <button \n          @click=\"refreshAllData\" \n          class=\"refresh-btn\"\n          :disabled=\"loading\"\n        >\n          <i class=\"fas fa-sync-alt\"></i>\n          Aktualisieren\n        </button>\n      </div>\n    </div>\n    \n    <!-- Statistics section -->\n    <FeedbackStats \n      :stats=\"feedbackStats\" \n      :date-range=\"selectedDateRange\"\n      :title=\"`Feedback-Statistiken (${dateRangeText})`\"\n      @refresh=\"refreshAllData\"\n    />\n    \n    <!-- Feedback list section -->\n    <FeedbackList \n      :feedback-items=\"feedbackItems\"\n      :loading=\"loading\"\n      :title=\"`Feedback-Einträge (${dateRangeText})`\"\n      :pagination=\"pagination\"\n      @view-message=\"handleViewFeedback\"\n      @view-session=\"handleViewSession\"\n      @filter-change=\"handleFilterChange\"\n      @search-change=\"handleSearchChange\"\n      @page-change=\"handlePageChange\"\n    />\n    \n    <!-- Feedback detail dialog -->\n    <div v-if=\"showDetailModal\" class=\"modal-overlay\" @click=\"closeDetailModal\">\n      <FeedbackDetail \n        v-if=\"selectedFeedback\"\n        :feedback=\"selectedFeedback\"\n        @close=\"closeDetailModal\"\n        @view-session=\"handleViewSession\"\n        @click.stop\n      />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useFeedbackStore } from '@/stores/feedbackStore';\nimport FeedbackStats from '@/components/admin/feedback/FeedbackStats.vue';\nimport FeedbackList from '@/components/admin/feedback/FeedbackList.vue';\nimport FeedbackDetail from '@/components/admin/feedback/FeedbackDetail.vue';\n\n// Store & Router\nconst feedbackStore = useFeedbackStore();\nconst router = useRouter();\n\n// Refs\nconst selectedDateRange = ref('last7days');\nconst showDetailModal = ref(false);\nconst selectedFeedback = ref(null);\nconst pollingInterval = ref(null);\n\n// Computed properties\nconst feedbackStats = computed(() => feedbackStore.stats);\nconst feedbackItems = computed(() => feedbackStore.feedbackItems);\nconst loading = computed(() => feedbackStore.loading || feedbackStore.statsLoading);\nconst dateRangeText = computed(() => feedbackStore.dateRangeFormatted);\nconst pagination = computed(() => feedbackStore.pagination);\n\n// Methods\nconst refreshAllData = async () => {\n  await Promise.all([\n    feedbackStore.loadStats(selectedDateRange.value),\n    feedbackStore.loadFeedback({ dateRange: selectedDateRange.value })\n  ]);\n};\n\nconst handleDateRangeChange = () => {\n  refreshAllData();\n};\n\nconst handleFilterChange = (filterType) => {\n  feedbackStore.loadFeedback({ type: filterType });\n};\n\nconst handleSearchChange = (query) => {\n  feedbackStore.loadFeedback({ search: query });\n};\n\nconst handlePageChange = (page) => {\n  feedbackStore.changePage(page);\n};\n\nconst handleViewFeedback = async (feedback) => {\n  // If we already have full feedback details with context, show it\n  if (feedback.context_messages) {\n    selectedFeedback.value = feedback;\n    showDetailModal.value = true;\n    return;\n  }\n  \n  // Otherwise, load full details first\n  const detailedFeedback = await feedbackStore.loadFeedbackDetail(feedback.id);\n  \n  if (detailedFeedback) {\n    // Load conversation context\n    await feedbackStore.loadFeedbackContext(\n      detailedFeedback.id, \n      detailedFeedback.session_id\n    );\n    \n    selectedFeedback.value = feedbackStore.selectedFeedback;\n    showDetailModal.value = true;\n  }\n};\n\nconst closeDetailModal = () => {\n  showDetailModal.value = false;\n  // Clear selection after a short delay (for animation)\n  setTimeout(() => {\n    selectedFeedback.value = null;\n  }, 300);\n};\n\nconst handleViewSession = (sessionId) => {\n  // Zur Chat-Ansicht mit der ausgewählten Session navigieren\n  console.log('Öffne Session:', sessionId);\n  \n  // Ggf. Dialog schließen, wenn geöffnet\n  if (showDetailModal.value) {\n    closeDetailModal();\n  }\n  \n  // Navigation zur Chat-Ansicht mit der Session-ID\n  router.push({ \n    name: 'ChatSession', \n    params: { sessionId }\n  });\n};\n\nconst exportFeedback = () => {\n  feedbackStore.exportFeedbackCsv(selectedDateRange.value);\n};\n\n// Start polling for updates\nconst startPolling = () => {\n  // Poll every 5 minutes for updates\n  pollingInterval.value = setInterval(() => {\n    refreshAllData();\n  }, 5 * 60 * 1000);\n};\n\n// Lifecycle hooks\nonMounted(async () => {\n  // Initial data load\n  await refreshAllData();\n  \n  // Start polling\n  startPolling();\n});\n\nonUnmounted(() => {\n  // Clear polling interval\n  if (pollingInterval.value) {\n    clearInterval(pollingInterval.value);\n  }\n});\n</script>\n\n<style scoped>\n.admin-feedback-view {\n  padding: 1.5rem;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.page-title {\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n}\n\n.header-actions {\n  display: flex;\n  gap: 0.75rem;\n  align-items: center;\n  flex-wrap: wrap;\n}\n\n.date-range-selector {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.selector-label {\n  font-size: 0.875rem;\n  color: #475569;\n}\n\n.date-range-select {\n  padding: 0.5rem 2rem 0.5rem 1rem;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.375rem;\n  background-color: white;\n  color: #1e293b;\n  font-size: 0.875rem;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 0.5rem center;\n  background-size: 1.25rem;\n}\n\n.export-btn, .refresh-btn {\n  padding: 0.5rem 1rem;\n  border: none;\n  border-radius: 0.375rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.export-btn {\n  background-color: #f8fafc;\n  color: #475569;\n  border: 1px solid #e2e8f0;\n}\n\n.export-btn:hover:not(:disabled) {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.refresh-btn {\n  background-color: #eff6ff;\n  color: #3b82f6;\n  border: 1px solid #bfdbfe;\n}\n\n.refresh-btn:hover:not(:disabled) {\n  background-color: #dbeafe;\n  color: #2563eb;\n}\n\n.export-btn:disabled, .refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Modal styling */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 1rem;\n}\n\n/* Dark Mode Support */\n:global(.theme-dark) .admin-feedback-view {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .page-title {\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .selector-label {\n  color: #bbb;\n}\n\n:global(.theme-dark) .date-range-select {\n  background-color: #252525;\n  border-color: #444;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .export-btn {\n  background-color: #252525;\n  color: #bbb;\n  border-color: #444;\n}\n\n:global(.theme-dark) .export-btn:hover:not(:disabled) {\n  background-color: #333;\n  color: #e0e0e0;\n}\n\n:global(.theme-dark) .refresh-btn {\n  background-color: #1a3668;\n  color: #90caf9;\n  border-color: #264f82;\n}\n\n:global(.theme-dark) .refresh-btn:hover:not(:disabled) {\n  background-color: #1e4072;\n  color: #bdd7f7;\n}\n\n:global(.theme-dark) .modal-overlay {\n  background-color: rgba(0, 0, 0, 0.7);\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .page-header {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n}\n</style>"],"names":["useFeedbackStore","defineStore","state","result","item","query","useAuthStore","dateRange","response","axios","error","_b","_a","options","feedbackId","sessionId","page","params","url","link","date","props","__props","chartContainer","ref","totalCount","computed","positiveCount","negativeCount","positivePercentage","feedbackRateClass","dateRangeText","renderChart","container","timeline","chartEl","day","barContainer","positiveBar","negativeBar","dateLabel","watch","onMounted","emit","__emit","activeFilter","searchQuery","expandedItems","expandedItemsQuestion","currentPage","filteredFeedback","hasActiveFilters","emptyStateMessage","hasPagination","totalPages","applyFilters","resetFilters","changePage","toggleExpand","toggleExpandQuestion","truncateMessage","message","shouldShowExpandButton","formatDate","dateString","newVal","expanded","isPositive","feedbackType","toggleExpanded","feedbackStore","router","useRouter","selectedDateRange","showDetailModal","selectedFeedback","pollingInterval","feedbackStats","feedbackItems","loading","pagination","refreshAllData","handleDateRangeChange","handleFilterChange","filterType","handleSearchChange","handlePageChange","handleViewFeedback","feedback","detailedFeedback","closeDetailModal","handleViewSession","exportFeedback","startPolling","onUnmounted"],"mappings":"iRAQO,MAAMA,GAAmBC,EAAY,WAAY,CACtD,MAAO,KAAO,CAEZ,MAAO,CACL,eAAgB,EAChB,eAAgB,EAChB,YAAa,EACb,oBAAqB,EACrB,SAAU,CAAE,CACb,EAGD,cAAe,CAAE,EAGjB,iBAAkB,KAGlB,OAAQ,CACN,KAAM,MACN,UAAW,YACX,OAAQ,GACR,KAAM,EACN,SAAU,EACX,EAGD,QAAS,GACT,aAAc,GACd,MAAO,KAGP,WAAY,CACV,QAAS,GACT,YAAa,EACb,WAAY,EACZ,WAAY,EACZ,aAAc,EACf,CACL,GAEE,QAAS,CAIP,iBAAmBC,GAAU,CAC3B,IAAIC,EAAS,CAAC,GAAGD,EAAM,aAAa,EAcpC,GAXIA,EAAM,OAAO,OAAS,QACpBA,EAAM,OAAO,OAAS,WACxBC,EAASA,EAAO,OAAOC,GAAQA,EAAK,WAAW,EACtCF,EAAM,OAAO,OAAS,WAC/BC,EAASA,EAAO,OAAOC,GAAQ,CAACA,EAAK,WAAW,EACvCF,EAAM,OAAO,OAAS,iBAC/BC,EAASA,EAAO,OAAOC,GAAQA,EAAK,SAAWA,EAAK,QAAQ,KAAI,EAAG,OAAS,CAAC,IAK7EF,EAAM,OAAO,OAAO,KAAI,EAAI,CAC9B,MAAMG,EAAQH,EAAM,OAAO,OAAO,YAAW,EAC7CC,EAASA,EAAO,OAAOC,GACpBA,EAAK,cAAgBA,EAAK,aAAa,YAAa,EAAC,SAASC,CAAK,GACnED,EAAK,SAAWA,EAAK,QAAQ,cAAc,SAASC,CAAK,CACpE,CACO,CAED,OAAOF,CACR,EAKD,kBAAmB,IACCG,IACD,gBAMnB,mBAAqBJ,GAAU,CAC7B,OAAQA,EAAM,OAAO,UAAS,CAC5B,IAAK,QACH,MAAO,QACT,IAAK,YACH,MAAO,UACT,IAAK,YACH,MAAO,gBACT,IAAK,aACH,MAAO,iBACT,IAAK,YACH,MAAO,eACT,IAAK,YACH,MAAO,gBACT,IAAK,WACH,MAAO,cACT,QACE,MAAO,aACV,CACF,CACF,EAED,QAAS,CAKP,MAAM,UAAUK,EAAY,KAAM,SAChC,GAAK,KAAK,kBAEV,MAAK,aAAe,GACpB,KAAK,MAAQ,KAGTA,IACF,KAAK,OAAO,UAAYA,GAG1B,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,4BAA6B,CAC5D,OAAQ,CACN,WAAY,KAAK,OAAO,SACzB,CACX,CAAS,EAED,KAAK,MAAQD,EAAS,IAEvB,OAAQE,EAAO,CACd,QAAQ,MAAM,8CAA+CA,CAAK,EAClE,KAAK,QAAQC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,4CACrD,QAAgB,CACR,KAAK,aAAe,EACrB,EACF,EAMD,MAAM,aAAaE,EAAU,GAAI,SAC/B,GAAK,KAAK,kBAEV,MAAK,QAAU,GACf,KAAK,MAAQ,KAGTA,EAAQ,OAAM,KAAK,OAAO,KAAOA,EAAQ,MACzCA,EAAQ,YAAW,KAAK,OAAO,UAAYA,EAAQ,WACnDA,EAAQ,SAAW,SAAW,KAAK,OAAO,OAASA,EAAQ,QAC3DA,EAAQ,OAAM,KAAK,OAAO,KAAOA,EAAQ,MAE7C,GAAI,CACF,MAAML,EAAW,MAAMC,EAAM,IAAI,sBAAuB,CACtD,OAAQ,CACN,KAAM,KAAK,OAAO,KAClB,WAAY,KAAK,OAAO,UACxB,OAAQ,KAAK,OAAO,OACpB,KAAM,KAAK,OAAO,KAClB,UAAW,KAAK,OAAO,QACxB,CACX,CAAS,EAED,KAAK,cAAgBD,EAAS,KAAK,OAAS,CAAA,EAG5C,KAAK,WAAa,CAChB,QAAS,GACT,YAAaA,EAAS,KAAK,MAAQ,EACnC,WAAYA,EAAS,KAAK,aAAe,EACzC,WAAYA,EAAS,KAAK,aAAe,EACzC,aAAcA,EAAS,KAAK,WAAa,EACnD,CAEO,OAAQE,EAAO,CACd,QAAQ,MAAM,wCAAyCA,CAAK,EAC5D,KAAK,QAAQC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,sCACrD,QAAgB,CACR,KAAK,QAAU,EAChB,EACF,EAMD,MAAM,mBAAmBG,EAAY,SACnC,GAAK,KAAK,kBAEV,MAAK,QAAU,GACf,KAAK,MAAQ,KAEb,GAAI,CACF,MAAMN,EAAW,MAAMC,EAAM,IAAI,uBAAuBK,CAAU,EAAE,EACpE,YAAK,iBAAmBN,EAAS,KAC1BA,EAAS,IACjB,OAAQE,EAAO,CACd,eAAQ,MAAM,0CAA2CA,CAAK,EAC9D,KAAK,QAAQC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,yCACtC,IACf,QAAgB,CACR,KAAK,QAAU,EAChB,EACF,EAOD,MAAM,oBAAoBG,EAAYC,EAAW,SAC/C,GAAK,KAAK,kBAEV,MAAK,QAAU,GACf,KAAK,MAAQ,KAEb,GAAI,CACF,MAAMP,EAAW,MAAMC,EAAM,IAAI,uBAAuBK,CAAU,WAAY,CAC5E,OAAQ,CACN,WAAYC,CACb,CACX,CAAS,EAGD,OAAI,KAAK,kBAAoB,KAAK,iBAAiB,KAAOD,IACxD,KAAK,iBAAiB,iBAAmBN,EAAS,KAAK,UAAY,IAG9DA,EAAS,KAAK,UAAY,EAClC,OAAQE,EAAO,CACd,eAAQ,MAAM,2CAA4CA,CAAK,EAC/D,KAAK,QAAQC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,0CACtC,EACf,QAAgB,CACR,KAAK,QAAU,EAChB,EACF,EAKD,aAAc,CACZ,KAAK,OAAS,CACZ,KAAM,MACN,UAAW,YACX,OAAQ,GACR,KAAM,EACN,SAAU,EAClB,EAGM,KAAK,aAAY,CAClB,EAMD,WAAWK,EAAM,CACXA,EAAO,GAAKA,EAAO,KAAK,WAAW,aAEvC,KAAK,OAAO,KAAOA,EACnB,KAAK,aAAY,EAClB,EAMD,MAAM,kBAAkBT,EAAY,KAAM,SACxC,GAAK,KAAK,kBAEV,MAAK,QAAU,GACf,KAAK,MAAQ,KAEb,GAAI,CACF,MAAMU,EAAS,CACb,WAAYV,GAAa,KAAK,OAAO,UACrC,KAAM,KAAK,OAAO,OAAS,MAAQ,KAAK,OAAO,KAAO,OACtD,OAAQ,KAAK,OAAO,OAAO,KAAM,GAAI,MAC/C,EAEcC,EAAW,MAAMC,EAAM,IAAI,6BAA8B,CAC7D,OAAAQ,EACA,aAAc,MACxB,CAAS,EAGKC,EAAM,OAAO,IAAI,gBAAgB,IAAI,KAAK,CAACV,EAAS,IAAI,CAAC,CAAC,EAC1DW,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAK,KAAOD,EAGZ,MAAME,EAAO,IAAI,OAAO,YAAa,EAAC,MAAM,GAAG,EAAE,CAAC,EAClD,OAAAD,EAAK,aAAa,WAAY,mBAAmBC,CAAI,MAAM,EAE3D,SAAS,KAAK,YAAYD,CAAI,EAC9BA,EAAK,MAAK,EACV,SAAS,KAAK,YAAYA,CAAI,EAEvB,EACR,OAAQT,EAAO,CACd,eAAQ,MAAM,8CAA+CA,CAAK,EAClE,KAAK,QAAQC,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,6CACtC,EACf,QAAgB,CACR,KAAK,QAAU,EAChB,EACF,CACF,CACH,CAAC,grBCzPD,MAAMU,EAAQC,EAuBRC,EAAiBC,EAAI,IAAI,EAGzBC,EAAaC,EAAS,IACnBL,EAAM,MAAM,eAAiBA,EAAM,MAAM,gBAAkB,CACnE,EAEKM,EAAgBD,EAAS,IACtBL,EAAM,MAAM,gBAAkB,CACtC,EAEKO,EAAgBF,EAAS,IACtBL,EAAM,MAAM,gBAAkB,CACtC,EAEKQ,EAAqBH,EAAS,IAC9BD,EAAW,QAAU,EAAU,EAC5B,KAAK,MAAOE,EAAc,MAAQF,EAAW,MAAS,GAAG,CACjE,EAEKK,EAAoBJ,EAAS,IAC7BG,EAAmB,OAAS,GAAW,WACvCA,EAAmB,OAAS,GAAW,UACpC,UACR,EAEKE,EAAgBL,EAAS,IAAM,CACnC,OAAQL,EAAM,UAAS,CACrB,IAAK,QACH,MAAO,QACT,IAAK,YACH,MAAO,UACT,IAAK,YACH,MAAO,gBACT,IAAK,aACH,MAAO,iBACT,IAAK,YACH,MAAO,eACT,IAAK,YACH,MAAO,gBACT,IAAK,WACH,MAAO,cACT,QACE,MAAO,aACX,CACF,CAAC,EAGKW,EAAc,IAAM,CACxB,GAAI,CAACT,EAAe,OAAS,CAACF,EAAM,MAAM,UAAY,CAACA,EAAM,UAAW,OAKxE,MAAMY,EAAYV,EAAe,MACjCU,EAAU,UAAY,GAGtB,MAAMC,EAAWb,EAAM,MAAM,UAAY,CAAA,EACzC,GAAIa,EAAS,SAAW,EAAG,CACzBD,EAAU,UAAY,0EACtB,MACF,CAGA,MAAME,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,eAGpBD,EAAS,QAAQE,GAAO,CACtB,MAAMC,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAY,gBAGzB,MAAMC,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,eACxBA,EAAY,MAAM,OAAS,GAAGF,EAAI,eAAiB,EAAE,KACrDE,EAAY,MAAQ,GAAGF,EAAI,IAAI,KAAKA,EAAI,cAAc,YAGtD,MAAMG,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,eACxBA,EAAY,MAAM,OAAS,GAAGH,EAAI,eAAiB,EAAE,KACrDG,EAAY,MAAQ,GAAGH,EAAI,IAAI,KAAKA,EAAI,cAAc,YAGtD,MAAMI,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,aACtBA,EAAU,YAAcJ,EAAI,KAAK,MAAM,GAAG,EAAE,CAAC,EAG7CC,EAAa,YAAYC,CAAW,EACpCD,EAAa,YAAYE,CAAW,EACpCF,EAAa,YAAYG,CAAS,EAGlCL,EAAQ,YAAYE,CAAY,CACpC,CAAG,EAGDJ,EAAU,YAAYE,CAAO,CAC/B,EAGA,OAAAM,EAAM,IAAMpB,EAAM,MAAO,IAAM,CAC7BW,GACF,EAAG,CAAE,KAAM,EAAI,CAAE,EAGjBU,EAAU,IAAM,CACdV,GACF,CAAC,60EC5CD,MAAMX,EAAQC,EAyBRqB,EAAOC,EASPC,EAAerB,EAAI,KAAK,EACxBsB,EAActB,EAAI,EAAE,EACpBuB,EAAgBvB,EAAI,CAAA,CAAE,EACtBwB,EAAwBxB,EAAI,CAAA,CAAE,EAC9ByB,EAAczB,IAAIZ,EAAAS,EAAM,aAAN,YAAAT,EAAkB,cAAe,CAAC,EAGpDsC,EAAmBxB,EAAS,IAAM,CACtC,IAAIvB,EAAS,CAAC,GAAGkB,EAAM,aAAa,EAcpC,GAXIwB,EAAa,QAAU,QACrBA,EAAa,QAAU,WACzB1C,EAASA,EAAO,OAAOC,GAAQA,EAAK,WAAW,EACtCyC,EAAa,QAAU,WAChC1C,EAASA,EAAO,OAAOC,GAAQ,CAACA,EAAK,WAAW,EACvCyC,EAAa,QAAU,iBAChC1C,EAASA,EAAO,OAAOC,GAAQA,EAAK,SAAWA,EAAK,QAAQ,KAAI,EAAG,OAAS,CAAC,IAK7E0C,EAAY,MAAM,OAAQ,CAC5B,MAAMzC,EAAQyC,EAAY,MAAM,YAAW,EAC3C3C,EAASA,EAAO,OAAOC,GACpBA,EAAK,cAAgBA,EAAK,aAAa,YAAa,EAAC,SAASC,CAAK,GACnED,EAAK,SAAWA,EAAK,QAAQ,cAAc,SAASC,CAAK,CAChE,CACE,CAEA,OAAOF,CACT,CAAC,EAEKgD,EAAmBzB,EAAS,IACzBmB,EAAa,QAAU,OAASC,EAAY,MAAM,KAAM,IAAK,EACrE,EAEKM,EAAoB1B,EAAS,IAC7ByB,EAAiB,MACZ,8CAEF,+BACR,EAEKE,EAAgB3B,EAAS,IACtBL,EAAM,YAAcA,EAAM,WAAW,OAC7C,EAEKiC,EAAa5B,EAAS,IAAM,OAChC,QAAOd,EAAAS,EAAM,aAAN,YAAAT,EAAkB,aAAc,CACzC,CAAC,EAGK2C,EAAe,IAAM,CACzBZ,EAAK,gBAAiBE,EAAa,KAAK,EACxCF,EAAK,gBAAiBG,EAAY,KAAK,EAGnCO,EAAc,OAASJ,EAAY,QAAU,IAC/CA,EAAY,MAAQ,EACpBN,EAAK,cAAe,CAAC,EAEzB,EAEMa,EAAe,IAAM,CACzBX,EAAa,MAAQ,MACrBC,EAAY,MAAQ,GACpBS,GACF,EAEME,EAAczC,GAAS,CAC3BiC,EAAY,MAAQjC,EACpB2B,EAAK,cAAe3B,CAAI,CAC1B,EAEM0C,EAAgB5C,GAAe,CACnCiC,EAAc,MAAQ,CACpB,GAAGA,EAAc,MACjB,CAACjC,CAAU,EAAG,CAACiC,EAAc,MAAMjC,CAAU,CACjD,CACA,EAEM6C,EAAwB7C,GAAe,CAC3CkC,EAAsB,MAAQ,CAC5B,GAAGA,EAAsB,MACzB,CAAClC,CAAU,EAAG,CAACkC,EAAsB,MAAMlC,CAAU,CACzD,CACA,EAEM8C,EAAmBC,GAClBA,EAGDd,EAAc,MAAMc,EAAQ,EAAE,EACzBA,EAILA,EAAQ,OAAS,IACZA,EAAQ,UAAU,EAAG,GAAG,EAAI,MAG9BA,EAZc,GAejBC,EAA0BD,GACvBA,GAAWA,EAAQ,OAAS,IAG/BE,EAAcC,GACbA,EAEQ,IAAI,KAAKA,CAAU,EACpB,eAAe,QAAS,CAClC,IAAK,UACL,MAAO,UACP,KAAM,UACN,KAAM,UACN,OAAQ,SACZ,CAAG,EATuB,GAa1B,OAAAvB,EAAM,IAAMpB,EAAM,WAAa4C,GAAW,CACpCA,GAAUA,EAAO,cACnBhB,EAAY,MAAQgB,EAAO,YAE/B,EAAG,CAAE,KAAM,EAAI,CAAE,k6HCjMjB,MAAM5C,EAAQC,EAeR4C,EAAW1C,EAAIH,EAAM,eAAe,EAGpC8C,EAAazC,EAAS,IACnBL,EAAM,SAAS,WACvB,EAEK+C,EAAe1C,EAAS,IACrByC,EAAW,MAAQ,WAAa,UACxC,EAGKE,EAAiB,IAAM,CAC3BH,EAAS,MAAQ,CAACA,EAAS,KAC7B,EAEMH,EAAcC,GACbA,EAEQ,IAAI,KAAKA,CAAU,EACpB,eAAe,QAAS,CAClC,IAAK,UACL,MAAO,UACP,KAAM,UACN,KAAM,UACN,OAAQ,UACR,OAAQ,SACZ,CAAG,EAVuB,+pFCtE1B,MAAMM,EAAgBtE,GAAgB,EAChCuE,EAASC,EAAS,EAGlBC,EAAoBjD,EAAI,WAAW,EACnCkD,EAAkBlD,EAAI,EAAK,EAC3BmD,EAAmBnD,EAAI,IAAI,EAC3BoD,EAAkBpD,EAAI,IAAI,EAG1BqD,EAAgBnD,EAAS,IAAM4C,EAAc,KAAK,EAClDQ,EAAgBpD,EAAS,IAAM4C,EAAc,aAAa,EAC1DS,EAAUrD,EAAS,IAAM4C,EAAc,SAAWA,EAAc,YAAY,EAC5EvC,EAAgBL,EAAS,IAAM4C,EAAc,kBAAkB,EAC/DU,EAAatD,EAAS,IAAM4C,EAAc,UAAU,EAGpDW,EAAiB,SAAY,CACjC,MAAM,QAAQ,IAAI,CAChBX,EAAc,UAAUG,EAAkB,KAAK,EAC/CH,EAAc,aAAa,CAAE,UAAWG,EAAkB,KAAK,CAAE,CACrE,CAAG,CACH,EAEMS,EAAwB,IAAM,CAClCD,GACF,EAEME,EAAsBC,GAAe,CACzCd,EAAc,aAAa,CAAE,KAAMc,CAAY,CAAA,CACjD,EAEMC,EAAsBhF,GAAU,CACpCiE,EAAc,aAAa,CAAE,OAAQjE,CAAO,CAAA,CAC9C,EAEMiF,EAAoBtE,GAAS,CACjCsD,EAAc,WAAWtD,CAAI,CAC/B,EAEMuE,EAAqB,MAAOC,GAAa,CAE7C,GAAIA,EAAS,iBAAkB,CAC7Bb,EAAiB,MAAQa,EACzBd,EAAgB,MAAQ,GACxB,MACF,CAGA,MAAMe,EAAmB,MAAMnB,EAAc,mBAAmBkB,EAAS,EAAE,EAEvEC,IAEF,MAAMnB,EAAc,oBAClBmB,EAAiB,GACjBA,EAAiB,UACvB,EAEId,EAAiB,MAAQL,EAAc,iBACvCI,EAAgB,MAAQ,GAE5B,EAEMgB,EAAmB,IAAM,CAC7BhB,EAAgB,MAAQ,GAExB,WAAW,IAAM,CACfC,EAAiB,MAAQ,IAC1B,EAAE,GAAG,CACR,EAEMgB,EAAqB5E,GAAc,CAEvC,QAAQ,IAAI,iBAAkBA,CAAS,EAGnC2D,EAAgB,OAClBgB,IAIFnB,EAAO,KAAK,CACV,KAAM,cACN,OAAQ,CAAE,UAAAxD,CAAU,CACxB,CAAG,CACH,EAEM6E,EAAiB,IAAM,CAC3BtB,EAAc,kBAAkBG,EAAkB,KAAK,CACzD,EAGMoB,EAAe,IAAM,CAEzBjB,EAAgB,MAAQ,YAAY,IAAM,CACxCK,GACJ,EAAK,EAAI,GAAK,GAAI,CAClB,EAGA,OAAAvC,EAAU,SAAY,CAEpB,MAAMuC,EAAc,EAGpBY,GACF,CAAC,EAEDC,EAAY,IAAM,CAEZlB,EAAgB,OAClB,cAAcA,EAAgB,KAAK,CAEvC,CAAC"}